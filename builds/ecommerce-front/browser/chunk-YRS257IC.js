import{a as w}from"./chunk-3VFHTPS6.js";import{a as k}from"./chunk-2YJE5SZQ.js";import{a as O}from"./chunk-RYMPJAZU.js";import"./chunk-CTBSQTUV.js";import"./chunk-NCCT54UK.js";import"./chunk-FDP5RWEF.js";import"./chunk-XALT67XN.js";import{h as E}from"./chunk-HGKDJBZM.js";import{Cb as l,Db as c,Eb as v,Ga as s,Gb as g,Hb as C,Ib as _,La as f,Pa as h,Pb as y,Rb as x,Ua as u,db as S,gb as b,hb as D,ib as t,jb as n,kb as m,sb as d,tb as T}from"./chunk-DN3HB7UR.js";import"./chunk-PYEHUVGI.js";var I=(a,e)=>e.userId;function M(a,e){a&1&&(t(0,"tr")(1,"td",12),l(2,"Cargando..."),n()())}function F(a,e){a&1&&(t(0,"tr")(1,"td",12),l(2,"No hay datos"),n()())}function B(a,e){if(a&1&&(t(0,"tr")(1,"td"),l(2),n(),t(3,"td"),l(4),n(),t(5,"td"),l(6),y(7,"number"),n()()),a&2){let o=e.$implicit,i=e.$index;s(2),c(i+1),s(2),c(o.fullName),s(2),v("Q ",x(7,3,o.totalSpent,"1.2-2"),"")}}function W(a,e){if(a&1&&b(0,B,8,6,"tr",null,I),a&2){let o=T();D(o.customers)}}var P=class a{constructor(e){this.reportService=e;let o=new Date,i=new Date(o.getFullYear(),0,1),p=new Date(o.getFullYear(),11,31);this.startDate=i.toISOString(),this.endDate=p.toISOString()}customers=[];startDate;endDate;loading=!1;ngOnInit(){this.loadData()}loadData(){this.loading=!0,this.reportService.getTopCustomersBySpending(this.startDate,this.endDate).subscribe({next:e=>{this.customers=e,this.loading=!1},error:()=>{this.loading=!1}})}onStartDateChange(e){this.startDate=e}onEndDateChange(e){this.endDate=e}onFilter(){this.loadData()}static \u0275fac=function(o){return new(o||a)(f(k))};static \u0275cmp=h({type:a,selectors:[["app-top-clients-sales"]],decls:31,vars:3,consts:[[1,"main-container"],[1,"body-container"],[1,"list-page-header-container"],["title","Top Clientes por Gasto","description","Clientes que m\xE1s dinero han gastado en el rango de fechas seleccionado"],[1,"body","bg-white","h-100"],[1,"table-main-container","d-flex","flex-column","gap-3","h-60"],[1,"table-actions","d-flex","align-items-center","gap-3"],[1,"form-label","fw-bold","mb-1"],[3,"modelChange","model"],[1,"btn","btn-primary",3,"click"],[1,"table-container"],[1,"table","sticky-header"],["colspan","3",1,"text-center","py-3","text-muted"]],template:function(o,i){o&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),m(3,"app-list-page-header",3),n(),t(4,"div",4)(5,"div",5)(6,"div",6)(7,"div")(8,"label",7),l(9,"Fecha inicio"),n(),t(10,"app-single-datepicker",8),_("modelChange",function(r){return C(i.startDate,r)||(i.startDate=r),r}),d("modelChange",function(r){return i.onStartDateChange(r)}),n()(),t(11,"div")(12,"label",7),l(13,"Fecha fin"),n(),t(14,"app-single-datepicker",8),_("modelChange",function(r){return C(i.endDate,r)||(i.endDate=r),r}),d("modelChange",function(r){return i.onEndDateChange(r)}),n()(),t(15,"div"),m(16,"label",7),t(17,"button",9),d("click",function(){return i.onFilter()}),l(18,"Filtrar"),n()()(),t(19,"div",10)(20,"table",11)(21,"tr")(22,"th"),l(23,"#"),n(),t(24,"th"),l(25,"Cliente"),n(),t(26,"th"),l(27,"Total Gastado"),n()(),u(28,M,3,0,"tr")(29,F,3,0,"tr")(30,W,2,0),n()()()()()()),o&2&&(s(10),g("model",i.startDate),s(4),g("model",i.endDate),s(14),S(i.loading?28:i.customers.length===0?29:30))},dependencies:[O,w,E],styles:[".table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;background-color:#f8f9fa}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.75rem}.table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f1f3f5}"]})};export{P as TopClientsSalesComponent};
